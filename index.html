<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Monitoring Report (Oct 2025)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <style>
        /* Custom Font */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .data-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            border-left: 5px solid;
        }
        .data-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        .chart-container {
            max-width: 100%;
            height: 400px;
            padding: 1rem;
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
        }
        /* Make charts responsive */
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
        @media (min-width: 1024px) {
            .chart-container {
                height: 450px;
            }
        }
        /* Table Styles */
        .data-table-container {
            overflow-x: auto;
            margin-top: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .data-table {
            width: 100%;
            min-width: 800px; /* Ensures horizontal scroll on small screens for large tables */
            border-collapse: collapse;
        }
        .data-table th, .data-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        .data-table th {
            background-color: #4f46e5;
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
        }
        .data-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .data-table tr:hover {
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-12 py-6 bg-white rounded-xl shadow-lg">
            <h1 class="text-4xl font-extrabold text-gray-900 tracking-tight">Data Monitoring Report</h1>
            <p class="mt-2 text-xl text-indigo-600 font-medium">1st Oct - 30th Oct 2025</p>
        </header>

        <!-- Section 1: Customer Overview -->
        <section id="customer-overview" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">1. Customer Overview & Growth</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Card 1: Paid Customers -->
                <div class="data-card bg-white p-6 rounded-xl shadow-md border-indigo-500 hover:bg-indigo-50">
                    <p class="text-sm font-semibold text-gray-500">Total Paid Customers</p>
                    <p class="text-5xl font-extrabold text-gray-900 mt-1">123</p>
                    <p class="text-sm mt-3 text-gray-600">
                        <span class="font-bold text-green-600">+5</span> customers since the previous period (118).
                    </p>
                </div>
                <!-- Card 2: New Customers -->
                <div class="data-card bg-white p-6 rounded-xl shadow-md border-green-500 hover:bg-green-50">
                    <p class="text-sm font-semibold text-gray-500">New Customers Onboarded</p>
                    <p class="text-5xl font-extrabold text-gray-900 mt-1">7</p>
                    <p class="text-sm mt-3 text-gray-600">
                        A total of 7 new customers were added this period.
                    </p>
                </div>
                <!-- Card 3: Dropped Customers -->
                <div class="data-card bg-white p-6 rounded-xl shadow-md border-red-500 hover:bg-red-50">
                    <p class="text-sm font-semibold text-gray-500">Dropped Customers</p>
                    <p class="text-5xl font-extrabold text-gray-900 mt-1">0</p>
                    <p class="text-sm mt-3 text-gray-600">
                        No customer churn recorded this period.
                    </p>
                </div>
            </div>
        </section>
         <!-- Section 2: New Customer Details (New Section) -->
        <section id="new-customer-details" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">2. New Customer Onboarding Details</h2>
            <div id="new-customer-cards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Cards will be injected here by JavaScript -->
            </div>
        </section>

        <!-- Section 3: Customer Data Summary (Pie Chart) -->
        <section id="customer-data-summary" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">3. Customer Data Breakdown (Pie Chart)</h2>
            <div class="chart-container">
                <canvas id="pieChartCustomerData"></canvas>
            </div>
            <p class="text-gray-600 mt-4 px-4">
                <span class="font-bold text-indigo-600">Insight:</span> The majority of the customer base is actively using the core software.</P>
                <p class="text-gray-600 mt-4 px-4">
                <span class="font-bold text-indigo-600">ChargeMix Users :</span> Brakes india foundry devision, Brakes india (naidupet), brakes india (folimetalic), Alchemy, Crescent. </P>
                <p class="text-gray-600 mt-4 px-4">
                <span class="font-bold text-indigo-600"> AI Users :</span> Indoshell and Patil Group </p>
        </section>

      
        <!-- Section 4: ChargeMix Usage (Bar Graph and Raw Data Table) -->
        <section id="chargemix-usage" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">4. ChargeMix Module Usage & Optimization</h2>
            <div class="chart-container">
                <canvas id="barChartChargeMix"></canvas>
            </div>
            <div class="bg-yellow-100 p-4 rounded-lg mt-4 text-sm text-yellow-800">
                <p class="font-bold">Amplitude Insight:</p>
                <p class="font-bold">Alchemy Precision Cast Pvt. Ltd.:</p> This is not our active user currently but they have created chargemix 2 and modified 75 chargemix in Oct.<br>
                <p class="font-bold"> All Customers : </p>Alchemy Precision Cast Pvt. Ltd., Brakes India Pvt Ltd Foundry Division and Brakes India Foundry Division (Naidupet) faced challenges in the chargemix modification process, particularly at Step 1, which had the highest drop rate.
                    While Alchemy achieved a 67% success rate, Brakes India Pvt Ltd Foundry Division achieved a 26% success rate and Brakes India recorded a 0% success rate, indicating a complete failure to complete modifications.</p>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300">4.1 ChargeMix Usage</h3>
            <div class="data-table-container">
                <table class="data-table bg-white">
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>New ChargeMix Created</th>
                            <th>New ChargeMix sucessfully Optimized</th>
                            <th>ChargeMix Modified</th>
                            <th>Modified ChargeMix Optimized</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Brakes India Foundry Division</td><td>9</td><td>8</td><td>10</td><td>10</td></tr>
                        <tr style="background-color: #fee2e2; color: #991b1b;">
                            <td class="font-bold">Alchemy Precision Cast Pvt Ltd</td>
                            <td>2</td>
                            <td>2</td>
                            <td>75</td>
                            <td>68</td>
                        </tr>
                        <tr><td>Brakes India Foundry Division Naidupet</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>
                        <tr><td>Brakes India Pvt Ltd (Flometallic Unit, Jhagadia)</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
                        <tr><td>BRAKES INDIA PRIVATE LIMITED UNIT 2</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
                        <tr><td>CRESCENT FOUNDRY CO PVT.LTD.</td><td>2</td><td>2</td><td>2</td><td>2</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
         <!-- Section 5: Software Turned Off (Cards) -->
        <section id="software-turned-off" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">5. Customers with Software Turned Off</h2>
            <div id="software-off-cards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards will be injected here by JavaScript -->
            </div>
        </section>


        <!-- Section 6: Production Plan Creation (Bar Graph and Raw Data Table) -->
        <section id="production-plan" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">6. Production Plan Graph</h2>
            <div class="chart-container">
                <canvas id="barChartProductionPlan"></canvas>
            </div>
            <div class="bg-yellow-100 p-4 rounded-lg mt-4 text-sm text-yellow-800">
                <p class="font-bold">Amplitude Insight:</p>
                <p>Production Plan creation success rates are extremely low compared to the previous period. Maxwell showed a 4% success rate (8m 54s completion time) and RAMKRISHNA FORGINGS LTD. a 14% success rate (2m 1s completion time). All other listed customers recorded 0% success rates, suggesting significant friction or early exits.</p>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300">6.1 Production Plan Data</h3>
            <div class="data-table-container">
                <table class="data-table bg-white">
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>Prev. Period Plans Created</th>
                            <th>Current Period Plans Created</th>
                            <th>Avg. Time to Create</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>RAMKRISHNA FORGINGS LTD.</td><td>0</td><td>4</td><td>2m 1s</td></tr>
                        <tr><td>Maxwell Auto Components Pvt Ltd.</td><td>5</td><td>1</td><td>8m 54s</td></tr>
                        <tr><td>Shree Kedar metals</td><td>8</td><td>0</td><td>-</td></tr>
                        <tr><td>Belgaum FerroCast Pvt Ltd</td><td>0</td><td>0</td><td>-</td></tr>
                        <tr><td>CRESCENT FOUNDRY CO PVT.LTD.(GJ)</td><td>0</td><td>0</td><td>-</td></tr>
                        <tr><td>P.C.Sons Castings Pvt Ltd</td><td>0</td><td>0</td><td>-</td></tr>
                        <tr><td>Vishwakarma Founders Pvt Ltd</td><td>0</td><td>0</td><td>-</td></tr>
                        <tr><td>Mal Metalliks Pvt. Ltd.</td><td>0</td><td>0</td><td>-</td></tr>
                        <tr><td>Sapre Precision Techologies</td><td>0</td><td>0</td><td>-</td></tr>
                        <tr><td>NIPHA EXPORTS PVT. LTD. SRP (FOUNDRY)</td><td>0</td><td>0</td><td>-</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 7: Heat Plan Creation and Completion (Bar Graph and Raw Data Table) -->
        <section id="heat-plan" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">7. Heat Plan Performance: Creation vs. Completion</h2>
            <div class="chart-container">
                <canvas id="barChartHeatPlan"></canvas>
            </div>
            <div class="bg-green-100 p-4 rounded-lg mt-4 text-sm text-green-800">
                <p class="font-bold">Amplitude Insight (Use Dupliacte plan feature):</p>
                <p>Vishwakarma Founders (95% completion, 5s avg time), Belgaum FerroCast (94% completion, 1m avg time), and Sapre Precision Tech. (86% completion, 1m 46s avg time) show they mostly use Duplicate heat plan.</p>
            </div>
             <div class="bg-yellow-100 p-4 rounded-lg mt-4 text-sm text-yellow-800">
                <p class="font-bold">Amplitude Insight (Use New Plan creation feature):</p>
                <p>RAMKRISHNA FORGINGS LTD. (37% completion, 5m 30s) and Maxwell Auto Components (50% completion, 9m 19s) take significantly more time, suggesting they mostly create new plan .</p>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300">7.1 Heat Plan Creation and Completion</h3>
            <div class="data-table-container">
                <table class="data-table bg-white">
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>HP Created (Prev.)</th>
                            <th>HP Completed (Prev.)</th>
                            <th>HP Created (Curr.)</th>
                            <th>HP Completed (Curr.)</th>
                            <th>Last HP Completed</th>
                            <th>Avg HP per Day</th>
                            <th>Benchmark (Avg HP/Day)</th>
                            <th>Avg Time to Create</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Vishwakarma Founders Pvt Ltd</td><td>2079</td><td>1260</td><td>1548</td><td>617</td><td>29-Oct-2025</td><td>77.4</td><td>45</td><td>5 sec</td></tr>
                        <tr><td>Mal Metalliks Pvt. Ltd.</td><td>1582</td><td>751</td><td>1149</td><td>552</td><td>30-Oct-2025</td><td>47.88</td><td>60</td><td>-</td></tr>
                        <tr><td>Belgaum FerroCast Pvt Ltd</td><td>1418</td><td>206</td><td>1356</td><td>206</td><td>30-Oct-2025</td><td>84.75</td><td>68</td><td>1m</td></tr>
                        <tr><td>Sapre Precision Technologies</td><td>170</td><td>7</td><td>74</td><td>0</td><td>-</td><td>37</td><td>15</td><td>1m 46s</td></tr>
                        <tr><td>Crescent Foundry Co Pvt. Ltd.</td><td>110</td><td>33</td><td>0</td><td>0</td><td>-</td><td>0</td><td>40</td><td>-</td></tr>
                        <tr><td>Shree Kedar metals</td><td>85</td><td>42</td><td>32</td><td>15</td><td>11-October-25</td><td>4</td><td>15</td><td>8s</td></tr>
                        <tr><td>P.C.Sons Castings Pvt Ltd</td><td>81</td><td>37</td><td>0</td><td>0</td><td>-</td><td>0</td><td>40</td><td>-</td></tr>
                        <tr><td>Maxwell Auto Components Pvt Ltd</td><td>40</td><td>6</td><td>2</td><td>1</td><td>04-Oct-2025</td><td>2</td><td>50</td><td>9m 19s</td></tr>
                        <tr><td>NIPHA EXPORTS PVT. LTD. SRP (FOUNDRY)</td><td>0</td><td>0</td><td>0</td><td>0</td><td>-</td><td>0</td><td>70</td><td>-</td></tr>
                        <tr><td>Ramkrishna Forgings Ltd</td><td>0</td><td>0</td><td>75</td><td>9</td><td>30-Oct-2025</td><td>12.5</td><td>-</td><td>5m 30s</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 8: Melting Section EAF (Bar Graph and Raw Data Table) -->
        <section id="melting-eaf" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">8. Melting Section EAF: Heat Submitted & Loss Recovery</h2>
            <div class="chart-container">
                <canvas id="barChartEAF"></canvas>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300">8.1 Melting Section EAF</h3>
            <div class="data-table-container">
                <table class="data-table bg-white">
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>Prev. Period Heat Submitted</th>
                            <th>Prev. Period %Loss Recover</th>
                            <th>Current Period Heat Submitted</th>
                            <th>Current Period %Loss Recover</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Titagarh Rail Systems Limited</td><td>98</td><td>15%</td><td>144</td><td>13%</td></tr>
                        <tr><td>TITAGARH STEEL</td><td>112</td><td>13%</td><td>109</td><td>14%</td></tr>
                        <tr><td>LOCO CASTINGS PRIVATE LIMITED</td><td>52</td><td>8%</td><td>0</td><td>0%</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 9: HMT Section Summary (Stacked Bar Graph and Raw Data Table) -->
<!-- Section 9: HMT Section Summary (Stacked Bar Graph and Raw Data Table) -->
<section id="hmt-summary" class="mb-12">
    <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">9. HMT Section Summary: Total Reports Created</h2>
    
    <div class="chart-container">
        <canvas id="barChartHMT"></canvas>
    </div>
    
    <!-- Insights Card -->
    <div class="bg-white rounded-lg shadow-lg p-6 mt-6 border-l-4 border-indigo-500">
        <h3 class="text-xl font-bold text-indigo-700 mb-4 flex items-center">
            <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"/>
            </svg>
            Amplitude Insights
        </h3>
        
        <div class="space-y-4">
            <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
                <p class="text-gray-700">
                    <span class="font-bold text-green-700">1. Customers actively benefiting:</span> Mantri metallics is using the system very well with 13 tensile report downloads, showing they get real value from the reports. [They test 3 types of report regularly, so we can provide the MTC access them]</span>
                </p>
            </div>
            
            <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500">
                <p class="text-gray-700">
                    <span class="font-bold text-yellow-700">2. Partially benefiting:</span> Kalyan, Sapre downloading reports frequently.
                </p>
            </div>
            
            <div class="bg-red-50 p-4 rounded-lg border-l-4 border-red-500">
                <p class="text-gray-700">
                    <span class="font-bold text-red-700">3. Not benefiting:</span> Maxwell, belgaum, ramkrishna, unimech, parvati,plasma,govind, who show they are not using this feature as they don't download the report.
                </p>
            </div>
            
            <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                <p class="text-gray-700">
                    <span class="font-bold text-blue-700">ðŸ“Œ Note:</span> (CRESCENT FOUNDRY CO PVT.LTD.(GJ)-1 Micro report), Mal Metalliks Pvt. Ltd.-1 Hardness report, NIPHA EXPORTS PVT. LTD. SRP (FOUNDRY)-44 Tensile report, Shree Kedar metals- 1 Micro report downloaded from Sep list in this period.
                </p>
            </div>
        </div>
    </div>
</section>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300">9.1 HMT Section Summary</h3>
            <!-- This table is very wide, wrapped in a responsive container -->
            <div class="data-table-container">
                <table class="data-table bg-white min-w-[1200px]">
                    <thead>
                        <tr>
                            <th>Company Name</th>
                            <th>Report Type</th>
                            <th>Last Created Date</th>
                            <th>Prev. Period</th>
                            <th>Curr. Period</th>
                            <th>Parsing Fail Count</th>
                            <th>Parsing Fail %</th>
                            <th>Downloads</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>KALYAN STEEL PRODUCTS PRIVATE LIMITED</td><td>Hardness</td><td>27-Sep-2025</td><td>144</td><td>0</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>KALYAN STEEL PRODUCTS PRIVATE LIMITED</td><td>Microstructure</td><td>10-Sep-2025</td><td>5</td><td>0</td><td>-</td><td>-</td><td>9</td></tr>
                        <tr><td>KALYAN STEEL PRODUCTS PRIVATE LIMITED</td><td>Tensile</td><td>30-Oct-2025</td><td>3</td><td>4</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Plasma Alloys Pvt. Ltd.</td><td>Hardness</td><td>16-Oct-2025</td><td>254</td><td>7</td><td>1</td><td>14.29%</td><td>-</td></tr>
                        <tr><td>Plasma Alloys Pvt. Ltd.</td><td>Microstructure</td><td>30-Oct-2025</td><td>1087</td><td>168</td><td>1</td><td>0.99%</td><td>1</td></tr>
                        <tr><td>Plasma Alloys Pvt. Ltd.</td><td>Tensile</td><td>28-Oct-2025</td><td>218</td><td>41</td><td>1</td><td>2.70%</td><td>-</td></tr>
                        <tr><td>MANTRI METALLICS PVT LTD</td><td>Hardness</td><td>30-Oct-2025</td><td>254</td><td>135</td><td>-</td><td>-</td><td>1</td></tr>
                        <tr><td>MANTRI METALLICS PVT LTD</td><td>Microstructure</td><td>30-Oct-2025</td><td>1087</td><td>1112</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>MANTRI METALLICS PVT LTD</td><td>Tensile</td><td>30-Oct-2025</td><td>218</td><td>178</td><td>-</td><td>-</td><td>13</td></tr>
                        <tr><td>Maxwell Auto Components Pvt Ltd.</td><td>hardness</td><td>15-Oct-2025</td><td>143</td><td>230</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Maxwell Auto Components Pvt Ltd.</td><td>microstructure</td><td>28-Oct-2025</td><td>102</td><td>28</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Maxwell Auto Components Pvt Ltd.</td><td>tensile</td><td>28-Oct-2025</td><td>83</td><td>45</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Belgaum FerroCast Pvt Ltd</td><td>hardness</td><td>30-Oct-2025</td><td>505</td><td>402</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Belgaum FerroCast Pvt Ltd</td><td>microstructure</td><td>27-Oct-2025</td><td>3</td><td>4</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Belgaum FerroCast Pvt Ltd</td><td>tensile</td><td>30-Oct-2025</td><td>854</td><td>703</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Vishwakarma Founders Pvt Ltd</td><td>hardness</td><td>10-Oct-2025</td><td>197</td><td>88</td><td>-</td><td>-</td><td>2</td></tr>
                        <tr><td>Vishwakarma Founders Pvt Ltd</td><td>microstructure</td><td>18-Oct-2025</td><td>125</td><td>212</td><td>1</td><td>0.005%</td><td>-</td></tr>
                        <tr><td>Vishwakarma Founders Pvt Ltd</td><td>tensile</td><td>28-Oct-2025</td><td>0</td><td>20</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>NIF ISPAT LIMITED (UNIT-IV)</td><td>hardness</td><td>15-Sep-2025</td><td>10</td><td>2</td><td>-</td><td>-</td><td>1</td></tr>
                        <tr><td>NIF ISPAT LIMITED (UNIT-IV)</td><td>microstructure</td><td>19-Oct-2025</td><td>383</td><td>427</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>NIF ISPAT LIMITED (UNIT-IV)</td><td>tensile</td><td>15-Sep-2025</td><td>20</td><td>2</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Mantri Metallics Pvt Ltd Pantnagar</td><td>hardness</td><td>30-Oct-2025</td><td>142</td><td>156</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Mantri Metallics Pvt Ltd Pantnagar</td><td>microstructure</td><td>30-Oct-2025</td><td>28</td><td>102 (all duplicate)</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Mantri Metallics Pvt Ltd Pantnagar</td><td>tensile</td><td>30-Oct-2025</td><td></td><td>49</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>GOVIND STEEL</td><td>microstructure</td><td>21-Oct-25</td><td>650</td><td>296</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>NIPHA EXPORTS PVT. LTD. SRP (FOUNDRY)</td><td>microstructure</td><td>22-Oct-2025</td><td>507</td><td>526</td><td>1</td><td>0.00%</td><td>-</td></tr>
                        <tr><td>RBA EXPORTS PRIVATE LIMITED TN</td><td>hardness</td><td>14-Oct-2025</td><td>2</td><td>8</td><td>-</td><td>-</td><td>1</td></tr>
                        <tr><td>RBA EXPORTS PRIVATE LIMITED TN</td><td>microstructure</td><td>14-Oct-2025</td><td>4</td><td>6</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>RBA EXPORTS PRIVATE LIMITED TN</td><td>tensile</td><td>21-Oct-2025</td><td>8</td><td>50</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Parvati Foundry</td><td>hardness</td><td>31-Aug-2025</td><td>0</td><td>0</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Parvati Foundry</td><td>microstructure</td><td>16-Oct-2025</td><td>202</td><td>152</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Parvati Foundry</td><td>tensile</td><td>30-Oct-2025</td><td>0</td><td>2</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Sapre Precision Techologies</td><td>hardness</td><td>30-Oct-2025</td><td>213</td><td>255</td><td>70</td><td>27.45%</td><td>4</td></tr>
                        <tr><td>Sapre Precision Techologies</td><td>microstructure</td><td>25-Oct-2025</td><td>12</td><td>8</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Sapre Precision Techologies</td><td>tensile</td><td>21-Sep-2025</td><td>4</td><td>0</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>RAMKRISHNA FORGINGS LTD.</td><td>microstructure</td><td>10-Oct-25</td><td>0</td><td>2</td><td>2</td><td>100.00%</td><td>-</td></tr>
                        <tr><td>RAMKRISHNA FORGINGS LTD.</td><td>tensile</td><td>29-Oct-25</td><td>0</td><td>1</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Unimech Industries Pvt Ltd</td><td>tensile</td><td>17-Oct-2025</td><td>93</td><td>12</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>SRIUNHAT METALIKS PVT. LTD</td><td>tensile</td><td>15-Oct-2025</td><td>22</td><td>152</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Mal Metalliks Pvt. Ltd.</td><td>tensile</td><td>29-Oct-25</td><td>7 (all duplicate)</td><td>12 (duplicate)</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Shree Kedar metals</td><td>tensile</td><td>30-Aug-2025</td><td>0</td><td>0</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>GOVIND STEEL</td><td>microstructure</td><td>21-Oct-2025</td><td>296</td><td>0</td><td>-</td><td>-</td><td>-</td></tr>
                        <tr><td>Unimech Industries Pvt Ltd</td><td>tensile</td><td>17-Oct-25</td><td>93</td><td>12</td><td>-</td><td>-</td><td>-</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 10: Casting Report - MTC (Bar Graph and Raw Data Table) -->
        <section id="casting-mtc" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2 border-indigo-200">10. Casting Report (MTC) Certificate Status</h2>
            <div class="chart-container">
                <canvas id="barChartMTC"></canvas>
            </div>
            <div class="bg-red-100 p-4 rounded-lg mt-4 text-sm text-red-800">
                <p class="font-bold">Amplitude Insight (Drop Points):</p>
                <ul class="list-disc ml-5 mt-2">
                    <li>**RBA Exports:** Dropped most during approval, part entry, and HMT (micro reading) finding stages (24 times).</li>
                    <li>**Vishwakarma Founders:** Dropped most during finding reading and HMT (hardness) report analysis data (25 times).</li>
                    <li>**Multiple Users:** Belgaum, Mal metalliks, plasma, ramkrishna, sapre, shree kedar were starting but didn't complete the process, dropping primarily in the finding PartNumber and SpectroReadings stage.</li>
                </ul>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300">10.1 Casting Report - MTC</h3>
            <div class="data-table-container">
                <table class="data-table bg-white">
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>Overall certificate recorded (Total/Complete/Pending)</th>
                            <th>Previous Period Certificate created</th>
                            <th>Current Period Certificate created</th>
                            <th>Attempt failed count in Oct</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>RBA EXPORTS PRIVATE LIMITED TN</td><td>Total: 11 / Complete: 11 / Pending: 0</td><td>2</td><td>9</td><td>24</td></tr>
                        <tr><td>Vishwakarma Founders Pvt Ltd</td><td>Total: 17 / Complete: 8 / Pending: 9</td><td>2</td><td>3</td><td>25</td></tr>
                        <tr><td>Parvati Foundry</td><td>Total: 3 / Complete: 2 / Pending: 1</td><td>2</td><td>1</td><td>0</td></tr>
                        <tr><td>Belgaum FerroCast Pvt Ltd</td><td>Total: 1 / Complete: 0 / Pending: 1</td><td>1</td><td>1</td><td>2</td></tr>
                        <tr><td>KALYAN STEEL PRODUCTS PRIVATE LIMITED</td><td>Total: 3 / Complete: 3 / Pending: 0</td><td>1</td><td>0</td><td>0</td></tr>
                        <tr><td>Mal Metalliks Pvt. Ltd.</td><td>Total: 12 / Complete: 0 / Pending: 12</td><td>0</td><td>0</td><td>1</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 11 & 12: Hardware & Overall Summary -->
        <section id="overall-summary" class="mb-12 bg-gray-100 p-8 rounded-xl shadow-inner">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Overall Summary & Key Insights</h2>

            <h3 class="text-2xl font-semibold text-indigo-700 mt-6 mb-3">11. Hardware Status & Utilization</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <!-- Hardware Cards (Hover to show data) - Kept for visualization/interactivity -->
                <div class="data-card bg-white p-4 rounded-xl shadow-md border-gray-400 hover:bg-gray-50">
                    <p class="text-md font-semibold text-gray-700">Spectro TV</p>
                    <p class="text-xl font-extrabold text-gray-900 mt-1" title="Hover for details">52 Customers</p>
                    <p class="text-xs text-gray-500 mt-2 hover-reveal">Devices Assigned: 71 | Customers On â‰¥1 Day: 40 | Devices On â‰¥5 Days: 47</p>
                </div>
                <div class="data-card bg-white p-4 rounded-xl shadow-md border-gray-400 hover:bg-gray-50">
                    <p class="text-md font-semibold text-gray-700">Spectro - Tablet</p>
                    <p class="text-xl font-extrabold text-gray-900 mt-1" title="Hover for details">11 Customers</p>
                    <p class="text-xs text-gray-500 mt-2 hover-reveal">Devices Assigned: 11 | Customers On â‰¥1 Day: 4 | Devices On â‰¥5 Days: 1</p>
                </div>
                <div class="data-card bg-white p-4 rounded-xl shadow-md border-gray-400 hover:bg-gray-50">
                    <p class="text-md font-semibold text-gray-700">DigiMelt - IF</p>
                    <p class="text-xl font-extrabold text-gray-900 mt-1" title="Hover for details">6 Customers</p>
                    <p class="text-xs text-gray-500 mt-2 hover-reveal">Devices Assigned: 7 | Customers On â‰¥1 Day: 4 | Devices On â‰¥5 Days: 3</p>
                </div>
                <div class="data-card bg-white p-4 rounded-xl shadow-md border-gray-400 hover:bg-gray-50">
                    <p class="text-md font-semibold text-gray-700">DigiMelt - EAF</p>
                    <p class="text-xl font-extrabold text-gray-900 mt-1" title="Hover for details">3 Customers</p>
                    <p class="text-xs text-gray-500 mt-2 hover-reveal">Devices Assigned: 5 | Customers On â‰¥1 Day: 1 | Devices On â‰¥5 Days: 2</p>
                </div>
                <div class="data-card bg-white p-4 rounded-xl shadow-md border-gray-400 hover:bg-gray-50">
                    <p class="text-md font-semibold text-gray-700">Heat Plan - Kiosk</p>
                    <p class="text-xl font-extrabold text-gray-900 mt-1" title="Hover for details">4 Customers</p>
                    <p class="text-xs text-gray-500 mt-2 hover-reveal">Devices Assigned: 6 | Customers On â‰¥1 Day: 3 | Devices On â‰¥5 Days: 1</p>
                </div>
            </div>

            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 border-gray-300 mt-6">Hardware Status (1 Month)</h3>
            <div class="data-table-container">
                <table class="data-table bg-white">
                    <thead>
                        <tr>
                            <th>Hardware Classification</th>
                            <th>Customers Onboarded</th>
                            <th>Devices Assigned</th>
                            <th>Customers On â‰¥1 Day</th>
                            <th>Devices On â‰¥5 Days</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Spectro TV</td><td>52</td><td>71</td><td>40</td><td>47</td></tr>
                        <tr><td>Spectro - Tablet</td><td>11</td><td>11</td><td>4</td><td>1</td></tr>
                        <tr><td>DigiMelt - IF</td><td>6</td><td>7</td><td>4</td><td>3</td></tr>
                        <tr><td>DigiMelt - EAF</td><td>3</td><td>5</td><td>1</td><td>2</td></tr>
                        <tr><td>Heat Plan - Kiosk</td><td>4</td><td>6</td><td>3</td><td>1</td></tr>
                    </tbody>
                </table>
            </div>

            <h3 class="text-2xl font-semibold text-indigo-700 mt-8 mb-4">12. Overall Engagement & Usage Observations</h3>
            <ul class="space-y-3 text-gray-700 list-disc ml-5">
                <li class="p-3 bg-white rounded-lg shadow-sm">
                    <span class="font-bold text-green-600">Active Benefiting:</span> **NIPHA Exports** is utilizing the system exceptionally well, evidenced by **34 report downloads**. Note that only micro reports are being generated, which is why they do not create MTC reports.
                </li>
                <li class="p-3 bg-white rounded-lg shadow-sm">
                    <span class="font-bold text-yellow-600">Partially Benefiting:</span> **Kalyan, Mantri, and Sapre** are showing good engagement by frequently downloading reports.
                </li>
                <li class="p-3 bg-white rounded-lg shadow-sm">
                    <span class="font-bold text-red-600">Underutilization Concern:</span> Customers like **Maxwell, Belgaum, Ramkrishna, Unimech, Parvati, and Govind** show low to no report downloads, suggesting they are **not utilizing the report feature effectively**.
                </li>
                <li class="p-3 bg-white rounded-lg shadow-sm">
                    <span class="font-bold text-indigo-600">Late Report Downloads:</span> Several customers downloaded reports from the **previous period** in the current period, including Crescent Foundry (Micro-1), Mal Metalliks (Hardness), NIPHA EXPORTS (Tensile, 44 users), and Shree Kedar Metals (Micro-1).
                </li>
            </ul>
        </section>

    </div>

    <script>
        // Data Definitions (Unchanged from original generation)
        const data = {
            // Section 3: Customer Data Summary (Pie Chart)
            customerSummary: {
                labels: ['Software ON (Core Usage)', 'Software OFF (Turned Off)', 'ChargeMix Users', 'Custom (AI User)'],
                counts: [117, 6, 5, 2],
            },
            // Section 4: ChargeMix Usage (Bar Chart)
            chargeMixUsage: {
                customers: ['Brakes India FD', 'Alchemy PC', 'Brakes India FD N', 'Brakes India P Ltd (F)', 'BRAKES INDIA UNIT 2', 'CRESCENT FOUNDRY'],
                createdOptimized: [9, 2, 0, 0, 0, 2],
                modifiedOptimized: [10, 75, 1, 0, 0, 2],
            },
            // Section 6: Production Plan Creation (Bar Chart - Current Plans Created)
            productionPlan: {
                customers: ['RAMKRISHNA FORGINGS LTD.', 'Maxwell Auto Components', 'Shree Kedar metals', 'Belgaum FerroCast', 'CRESCENT FOUNDRY CO', 'P.C.Sons Castings', 'Vishwakarma Founders', 'Mal Metalliks', 'Sapre Precision', 'NIPHA EXPORTS'],
                currentCreated: [4, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                avgTime: [121, 534, 0, 0, 0, 0, 0, 0, 0, 0], // In seconds (2m 1s, 8m 54s)
            },
            // Section 7: Heat Plan Creation and Completion (Bar Chart)
            heatPlan: {
                customers: ['Vishwakarma Founders', 'Mal Metalliks', 'Belgaum FerroCast', 'Sapre Precision', 'Crescent Foundry', 'Shree Kedar metals', 'P.C.Sons Castings', 'Maxwell Auto Comp', 'NIPHA EXPORTS', 'Ramkrishna Forgings'],
                currentCreated: [1548, 1149, 1356, 74, 0, 32, 0, 2, 0, 75],
                currentCompleted: [617, 552, 206, 0, 0, 15, 0, 1, 0, 9],
                benchmark: [45 * 30, 60 * 30, 68 * 30, 15 * 30, 40 * 30, 15 * 30, 40 * 30, 50 * 30, 70 * 30, 0], // Benchmark * 30 days
            },
            // Section 8: Melting Section EAF (Bar Chart)
            meltingEAF: {
                customers: ['Titagarh Rail Systems Ltd', 'TITAGARH STEEL', 'LOCO CASTINGS PVT LTD'],
                heatSubmitted: [144, 109, 0],
                lossRecover: [13, 14, 0], // *100 for percentage label
            },
            // Section 9: HMT Section Summary (Stacked Bar Chart - Current Counts)
            hmtSummary: {
                labels: ['Hardness', 'Microstructure', 'Tensile'],
                counts: [
                    1283, // Sum Hardness (0+7+135+230+402+88+2+156+8+0+255)
                    3543, // Sum Microstructure (0+168+1112+28+4+212+427+102+296+526+6+152+8+2+0)
                    1283, // Sum Tensile (4+41+178+45+703+20+2+49+50+2+0+1+12+152+12)
                ],
            },
            // Section 10: Casting Report - MTC (Bar Chart)
            mtcReport: {
                customers: ['RBA EXPORTS', 'Vishwakarma Founders', 'Parvati Foundry', 'Belgaum FerroCast', 'KALYAN STEEL', 'Mal Metalliks'],
                total: [11, 17, 3, 1, 3, 12],
                complete: [11, 8, 2, 0, 3, 0],
                pending: [0, 9, 1, 1, 0, 12],
                dropCount: [33, 28, 1, 3, 0, 1],
            }
        };
        
         // Data for Section 2 - New Customer Details
const newCustomerDetails = [
    { name: 'Ammarun Foundries', module: 'Suggestion', region: 'Tamil nadu', subRegion: 'Coimbatore', remarks: 'paid customer' },
    { name: 'Ferro links-Chennai', module: 'Suggestion', region: 'Tamil nadu', subRegion: 'Chennai', remarks: 'paid customer' },
    { name: 'Patil Group of Industries', module: 'Production plan + heat plan + Ai user', region: 'Talengana', subRegion: 'Talengana', remarks: 'paid customer' },
    { name: 'Perumal Foundry', module: 'Suggestion', region: 'Tamil nadu', subRegion: 'Coimbatore', remarks: 'paid customer' },
    { name: 'Rausheena Group', module: 'Suggestion', region: 'Assam', subRegion: 'Guwahati', remarks: 'paid customer' },
    { name: 'Sasco Steel Pvt. Ltd.', module: 'Suggestion', region: 'Jharkhand', subRegion: 'Jamshedpur', remarks: 'paid customer' },
    { name: 'MALNAD PRIME MACHINING TECHNOLOGIES PRIVATE LIMITED', module: 'Suggestion', region: 'Maharashtra', subRegion: 'Shimoga', remarks: 'paid customer' },
];

 // Data for Section 5 - Software Turned Off (New Data Structure)
        const softwareOffCustomers = [
            { name: 'Top-Gear Metals Pvt Ltd', date: '15-May-25', feature: 'Suggestion', cluster: 'Maharashtra', subCluster: 'Kolhapur' },
            { name: 'S.N.S. Alloy Castings', date: '26-Aug-25', feature: 'Suggestion', cluster: 'Karnataka', subCluster: 'Shimoga' },
            { name: 'Bhuvan Industry', date: '08-Sep-25', feature: 'Suggestion', cluster: 'Karnataka', subCluster: 'Shimoga' },
            { name: 'Alchemy Precision Cast Pvt Ltd', date: '08-Aug-25', feature: 'Charge Mix + Suggestion', cluster: 'Maharashtra', subCluster: 'Pune' },
            { name: 'SAN PRECISION ALLOYS PRIVATE LIMITED', date: '04-Jul-25', feature: 'Reading Compare', cluster: 'Tamil Nadu', subCluster: 'Coimbatore' },
            { name: 'Versetile Industries', date: '08-Sep-25', feature: 'Reading Compare', cluster: 'Tamil Nadu', subCluster: 'Coimbatore' },
        ];

        // Utility to convert seconds to a readable time format
        const formatTime = (seconds) => {
            if (seconds === 0) return 'N/A';
            const m = Math.floor(seconds / 60);
            const s = seconds % 60;
            return `${m}m ${s}s`;
        };
         // Function to render the new customer cards for Section 2
        function renderNewCustomerCards() {
            const container = document.getElementById('new-customer-cards');
            if (!container) return;

            newCustomerDetails.forEach(customer => {
                const card = document.createElement('div');
                card.className = 'bg-white p-5 rounded-xl shadow-lg border-l-4 border-green-500 transition-all duration-300 hover:shadow-xl hover:bg-green-50';
                card.innerHTML = `
                    <h3 class="text-lg font-bold text-green-700 mb-2">${customer.name}</h3>
                        <p><span class="font-semibold text-gray-900">Module:</span> <span class="bg-green-100 text-green-800 px-2 py-0.5 rounded text-xs font-medium">${customer.module}</span></p>
                        <p><span class="font-semibold text-gray-900">Region:</span> ${customer.region}</p>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        function renderSoftwareOffCards() {
            const container = document.getElementById('software-off-cards');
            if (!container) return;

            softwareOffCustomers.forEach(customer => {
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-xl shadow-lg border-l-4 border-red-500 transition-all duration-300 hover:shadow-xl hover:bg-red-50';
                card.innerHTML = `
                    <h3 class="text-xl font-bold text-red-700 mb-3">${customer.name}</h3>
                    <div class="space-y-1.5 text-gray-700">
                        <p class="text-sm"><span class="font-semibold text-gray-900">Turn Off Date:</span> ${customer.date}</p>
                        <p class="text-sm"><span class="font-semibold text-gray-900">Opt-in Feature:</span> <span class="bg-red-100 text-red-800 px-2 py-0.5 rounded text-xs font-medium">${customer.feature}</span></p>
                        <p class="text-sm"><span class="font-semibold text-gray-900">Cluster:</span> ${customer.cluster}</p>
                        <p class="text-sm"><span class="font-semibold text-gray-900">Sub-Cluster:</span> ${customer.subCluster}</p>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // --- Chart Initialization Functions --- (Unchanged from original generation)

        // 3. Customer Data Summary (Pie Chart)
        function createPieChartCustomerData() {
            const ctx = document.getElementById('pieChartCustomerData').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: data.customerSummary.labels,
                    datasets: [{
                        data: data.customerSummary.counts,
                        backgroundColor: ['#4f46e5', '#ef4444', '#f59e0b', '#10b981'],
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { font: { size: 14 } } },
                        title: { display: true, text: 'Customer Base Breakdown (Total: 130)', font: { size: 18, weight: 'bold' } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) label += ': ';
                                    if (context.parsed !== null) label += context.parsed;
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // 4. ChargeMix Usage (Grouped Bar Chart)
        function createBarChartChargeMix() {
            const ctx = document.getElementById('barChartChargeMix').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.chargeMixUsage.customers,
                    datasets: [
                        {
                            label: 'Created ChargeMix Optimized',
                            data: data.chargeMixUsage.createdOptimized,
                            backgroundColor: '#4f46e5',
                            hoverBackgroundColor: '#6366f1',
                            stack: 'Optimization',
                        },
                        {
                            label: 'Modified ChargeMix Optimized',
                            data: data.chargeMixUsage.modifiedOptimized,
                            backgroundColor: '#10b981',
                            hoverBackgroundColor: '#34d399',
                            stack: 'Optimization',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'ChargeMix Optimization Success (Created vs. Modified)', font: { size: 18, weight: 'bold' } },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        x: { stacked: false, title: { display: true, text: 'Customer' } },
                        y: { stacked: false, title: { display: true, text: 'Number of Optimized ChargeMixes' } }
                    }
                }
            });
        }

        // 6. Production Plan Creation (Bar Chart - Current Created)
        function createBarChartProductionPlan() {
            const ctx = document.getElementById('barChartProductionPlan').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.productionPlan.customers,
                    datasets: [
                        {
                            label: 'Current Plans Created',
                            data: data.productionPlan.currentCreated,
                            backgroundColor: '#f59e0b',
                            hoverBackgroundColor: '#fbbf24',
                        },
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'Production Plans Created (Current Period)', font: { size: 18, weight: 'bold' } },
                        tooltip: {
                            callbacks: {
                                footer: (tooltipItems) => {
                                    const index = tooltipItems[0].dataIndex;
                                    const timeInSeconds = data.productionPlan.avgTime[index];
                                    return `Avg. Time: ${formatTime(timeInSeconds)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Customer' } },
                        y: { beginAtZero: true, title: { display: true, text: 'Number of Plans' } }
                    }
                }
            });
        }

        // 7. Heat Plan Creation and Completion (Stacked Bar Chart: Created vs. Completed vs. Benchmark)
        function createBarChartHeatPlan() {
            const ctx = document.getElementById('barChartHeatPlan').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.heatPlan.customers,
                    datasets: [
                        {
                            label: 'Completed Plans (Current)',
                            data: data.heatPlan.currentCompleted,
                            backgroundColor: '#2563eb',
                            hoverBackgroundColor: '#3b82f6',
                        },
                        {
                            label: 'Created Plans (Uncompleted)',
                            data: data.heatPlan.currentCreated.map((created, i) => created - data.heatPlan.currentCompleted[i]),
                            backgroundColor: '#bfdbfe',
                            hoverBackgroundColor: '#93c5fd',
                        },
                        {
                            label: 'Benchmark Target (Monthly)',
                            data: data.heatPlan.benchmark,
                            type: 'line',
                            borderColor: '#ef4444',
                            borderWidth: 2,
                            pointRadius: 3,
                            fill: false,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'Heat Plan Performance (Created, Completed, and Benchmark)', font: { size: 18, weight: 'bold' } },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Customer' } },
                        y: { beginAtZero: true, title: { display: true, text: 'Total Plans (Monthly)' } }
                    }
                }
            });
        }

        // 8. Melting Section EAF (Grouped Bar Chart)
        function createBarChartEAF() {
            const ctx = document.getElementById('barChartEAF').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.meltingEAF.customers,
                    datasets: [
                        {
                            label: 'Current Period Heat Submitted',
                            data: data.meltingEAF.heatSubmitted,
                            backgroundColor: '#059669',
                            hoverBackgroundColor: '#10b981',
                            yAxisID: 'y'
                        },
                        {
                            label: '% Loss Recover (Current Period)',
                            data: data.meltingEAF.lossRecover,
                            backgroundColor: '#f97316',
                            hoverBackgroundColor: '#fb923c',
                            yAxisID: 'y1',
                            // Custom tooltip label to show percentage
                            tooltip: {
                                callbacks: {
                                    label: (context) => {
                                        let label = context.dataset.label || '';
                                        if (label) label += ': ';
                                        label += context.parsed.y + '%';
                                        return label;
                                    }
                                }
                            }
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'Melting Section EAF: Heat & Recovery', font: { size: 18, weight: 'bold' } },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Customer' } },
                        y: { type: 'linear', position: 'left', title: { display: true, text: 'Heat Submitted (Count)' } },
                        y1: { type: 'linear', position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: '% Loss Recover' }, ticks: { callback: (value) => value + '%' } }
                    }
                }
            });
        }

        // 9. HMT Section Summary (Bar Chart - Aggregated)
        function createBarChartHMT() {
            const ctx = document.getElementById('barChartHMT').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.hmtSummary.labels,
                    datasets: [
                        {
                            label: 'Total Reports Created (Current Period)',
                            data: data.hmtSummary.counts,
                            backgroundColor: ['#4c1d95', '#7c3aed', '#a78bfa'],
                            hoverBackgroundColor: ['#5b21b6', '#8b5cf6', '#c4b5fd'],
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'Aggregated HMT Reports Created by Type (Current Period)', font: { size: 18, weight: 'bold' } },
                        legend: { display: false }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Report Type' } },
                        y: { beginAtZero: true, title: { display: true, text: 'Total Documents' } }
                    }
                }
            });
        }

        // 10. Casting Report - MTC (Stacked Bar Chart: Completed vs. Pending)
        function createBarChartMTC() {
            const ctx = document.getElementById('barChartMTC').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.mtcReport.customers,
                    datasets: [
                        {
                            label: 'Completed Certificates',
                            data: data.mtcReport.complete,
                            backgroundColor: '#06b6d4',
                            hoverBackgroundColor: '#22d3ee',
                            stack: 'MTC',
                        },
                        {
                            label: 'Pending Certificates',
                            data: data.mtcReport.pending,
                            backgroundColor: '#fcd34d',
                            hoverBackgroundColor: '#fde047',
                            stack: 'MTC',
                        },
                        {
                            label: 'Attempt failed Count in oct',
                            data: data.mtcReport.dropCount,
                            type: 'line',
                            borderColor: '#ef4444',
                            borderWidth: 2,
                            pointRadius: 4,
                            fill: false,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'MTC Certificates (Completed vs. Pending) and Drop Count', font: { size: 18, weight: 'bold' } },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        x: { stacked: true, title: { display: true, text: 'Customer' } },
                        y: { stacked: true, position: 'left', title: { display: true, text: 'Certificates (Count)' } },
                        y1: { type: 'linear', position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Drop Count (Line)' }, ticks: { color: '#ef4444' } }
                    }
                }
            });
        }


        // Initialize all charts on window load
        window.onload = function() {
            renderNewCustomerCards(); // New call for Section 2
            createPieChartCustomerData();
            renderSoftwareOffCards(); // New call for Section 5
            createBarChartChargeMix();
            createBarChartProductionPlan();
            createBarChartHeatPlan();
            createBarChartEAF();
            createBarChartHMT();
            createBarChartMTC();
        };
    </script>
</body>
</html>
